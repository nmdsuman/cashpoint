<!DOCTYPE html>
<!-- Admin-only Tournament Panel: duplicated from turnament.html so /admin-t uses a separate file. -->
<!-- Note: This file was generated as a copy of turnament.html at time of creation to decouple admin from user page. -->

<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tournament Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script defer src="/_vercel/insights/script.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
  <div id="container" class="w-full max-w-sm bg-white rounded-2xl shadow-xl p-6 space-y-4 text-center">
    <h1 class="text-xl font-bold text-gray-800">Tournament Admin</h1>
    <div id="status" class="text-gray-600">লোড হচ্ছে...</div>
    <div id="actions" class="hidden space-y-3">
      <a href="/turnament" class="block w-full py-3 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700">টুর্নামেন্ট ড্যাশবোর্ড খুলুন</a>
      <a href="/" class="block w-full py-3 bg-gray-400 text-white font-semibold rounded-xl hover:bg-gray-500">হোমে ফিরে যান</a>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCb9v4Q8XsaBKpnopMHE_5_aXEEMkEQork",
      authDomain: "cashpoint-f8b51.firebaseapp.com",
      projectId: "cashpoint-f8b51",
      storageBucket: "cashpoint-f8b51.firebasestorage.app",
      messagingSenderId: "50891144664",
      appId: "1:50891144664:web:e90f63977c95c86c04c6ad",
      measurementId: "G-WJXSMFBEE6"
    };
    const appId = 'cashpoint-f8b51';

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const statusEl = document.getElementById('status');
    const actionsEl = document.getElementById('actions');

    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        statusEl.textContent = 'লগইন করা প্রয়োজন। দয়া করে হোম পেজে গিয়ে লগইন করুন।';
        actionsEl.classList.remove('hidden');
        return;
      }

      try {
        statusEl.textContent = 'অ্যাডমিন যাচাই করা হচ্ছে...';
        const tokenResult = await user.getIdTokenResult(true);
        const isAdmin = !!tokenResult.claims.admin;
        if (isAdmin) {
          statusEl.textContent = 'রিডাইরেক্ট করা হচ্ছে...';
          window.location.href = '/turnament';
        } else {
          statusEl.textContent = 'আপনার অ্যাডমিন অনুমতি নেই।';
          actionsEl.classList.remove('hidden');
        }
      } catch (e) {
        console.error(e);
        statusEl.textContent = 'একটি ত্রুটি হয়েছে। পরে আবার চেষ্টা করুন।';
        actionsEl.classList.remove('hidden');
      }
    });
  </script>
</body>
</html>
